<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Andrew Bean, Sebastian Weber, Lukas Widmer" />

<meta name="date" content="2025-03-17" />

<title>Guiding Oncology Dose-Escalation Trials</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Guiding Oncology Dose-Escalation
Trials</h1>
<h4 class="author">Andrew Bean, Sebastian Weber, Lukas Widmer</h4>
<h4 class="date">2025-03-17</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The <code>OncoBayes2</code> package provides flexible functions for
Bayesian meta-analytic modeling of the incidence of Dose Limiting
Toxicities (DLTs) by dose level, under treatment regimes involving any
number of combination partners. Such models may be used to ensure
patient safety during trial conduct by supporting dose-escalation
decisions. In addition, the model can support estimation of the Maximum
Tolerated Dose (MTD) in adaptive Bayesian dose-escalation designs.</p>
<p>Whereas traditional dose escalation designs, such as the 3+3 design,
base the dosing decisions on predefined rules about the number of DLTs
in the last one or two cohorts at the current dose, model-based designs
such as those using Bayesian Logistic Regression Models (BLRMs) endeavor
to model the dose-toxicity relationship as a continuous curve, and allow
the model to guide dosing decisions. In this way, all available data
contributes to the dosing decisions. Furthermore, extensions to the BLRM
approach can support inclusion of available additional data on the
compound(s) involved. The additional data can be either historical data
collected prior trial conduct or concurrent data, which is collected
during trial conduct in the context of another trial/context.</p>
<p>The package supports incorporation of additional data through a
Meta-Analytic-Combined (MAC) framework [1]. Within the MAC model the
heterogeneous sources of data are assigned to <em>groups</em> and
information is shared across groups through a hierarchical model
structure. For any given group this leads to borrowing strength from all
other groups while discounting the information from other groups. The
amount of discounting (or down-weighting) is determined by the
heterogeneity. A group is commonly defined to be a trial, but that must
not necessarily hold.</p>
<p>The key assumption of the hierarchical model is the exchangability
assumption between the groups. There are two independent mechanisms in
the package which aim at relaxing the exchangability assumption:</p>
<ul>
<li><p>Differential discounting: Groups are assigned to different
strata. While the overall hierarchical mean stays the same, the
heterogeneity between groups is allowed to be different between strata.
Each group must be assigned to a single stratum only.</p></li>
<li><p>EXchangeable/Non-EXchangeable (EX/NEX) model for each group: With
EXNEX each group is modelled as being exchangeable with some probability
and is allowed to have it’s own group-specific estimate as if the group
is not exchangeable with the remainder of the data.</p></li>
</ul>
<p>Both techniques are rather advanced and are not discussed further in
this introduction.</p>
<p>In the following we illustrate first a very common use case of
historical information only and then consider concurrent data in
addition. In particular, we will discuss a trial evaluating a
combination of two drugs whenever historical information is available on
each drug individually from separate trials. This example will be
expanded by using in addition concurrent data on one of the drugs and on
their combination.</p>
<p><strong>Note on terminology:</strong> While in the literature (see
[1], [2], and [4]) the term <em>stratum</em> refers to a trial commonly,
<code>OncoBayes2</code> deviates here and uses the term <em>group</em>
instead. This is more in line with hierarchical modeling terminology.
The term <em>stratum</em> is used to define a higher level grouping
structure. That is, every group is assigned to a single <em>stratum</em>
within <code>OncoBayes2</code>. This higher level grouping (groups of
groups) is necessary whenever differential discounting is used. By
convention <code>OncoBayes2</code> assigns any group to the stratum
“all” whenever no stratum is assigned for a group.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="do">## Load involved packages</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(RBesT)   <span class="do">## used to define priors</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)   <span class="do">## for mutate</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(tidyr)   <span class="do">## defines expand_grid</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(tibble)  <span class="do">## for tibbles</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">library</span>(ggplot2) <span class="do">## for plotting</span></span></code></pre></div>
</div>
<div id="example-use-case-dual-combination-trial-with-historical-information" class="section level2">
<h2>Example use-case: Dual combination trial with historical
information</h2>
<p>Consider the application described in Section 3.2 of [1], in which
the risk of DLT is to be studied as a function of dose for two drugs,
drug A and drug B. Historical information on the toxicity profiles of
these two drugs is available from single agent trials
<code>trial_A</code> and <code>trial_B</code>. The historical data for
this example is available in an internal data set.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">kable</span>(hist_combo2)</span></code></pre></div>
<table>
<thead>
<tr>
<th align="left">group_id</th>
<th align="right">drug_A</th>
<th align="right">drug_B</th>
<th align="right">num_patients</th>
<th align="right">num_toxicities</th>
<th align="right">cohort_time</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">trial_A</td>
<td align="right">3.0</td>
<td align="right">0.0</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr>
<td align="left">trial_A</td>
<td align="right">4.5</td>
<td align="right">0.0</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr>
<td align="left">trial_A</td>
<td align="right">6.0</td>
<td align="right">0.0</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr>
<td align="left">trial_A</td>
<td align="right">8.0</td>
<td align="right">0.0</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr>
<td align="left">trial_B</td>
<td align="right">0.0</td>
<td align="right">33.3</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr>
<td align="left">trial_B</td>
<td align="right">0.0</td>
<td align="right">50.0</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr>
<td align="left">trial_B</td>
<td align="right">0.0</td>
<td align="right">100.0</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr>
<td align="left">trial_B</td>
<td align="right">0.0</td>
<td align="right">200.0</td>
<td align="right">9</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr>
<td align="left">trial_B</td>
<td align="right">0.0</td>
<td align="right">400.0</td>
<td align="right">15</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr>
<td align="left">trial_B</td>
<td align="right">0.0</td>
<td align="right">800.0</td>
<td align="right">20</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr>
<td align="left">trial_B</td>
<td align="right">0.0</td>
<td align="right">1120.0</td>
<td align="right">17</td>
<td align="right">4</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>The objective is to aid dosing and dose-escalation decisions in a
future trial, <code>trial_AB</code>, in which the drugs will be
combined. Additionally, another investigator-initiated trial
<code>IIT</code> will study the same combination concurrently. Note that
these as-yet-unobserved sources of data are included in the input data
as unobserved factor levels. This mechanism allows us to specify a joint
meta-analytic prior for all four sources of historical and concurrent
data.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">levels</span>(hist_combo2<span class="sc">$</span>group_id)</span></code></pre></div>
<pre><code>## [1] &quot;trial_A&quot;  &quot;trial_B&quot;  &quot;IIT&quot;      &quot;trial_AB&quot;</code></pre>
<p>However, we will first consider only the dual combination trial AB
and it’s historical data and add concurrent data at a later stage.</p>
<div id="setting-up-the-trial-design" class="section level3">
<h3>Setting up the trial design</h3>
<p>The function <code>blrm_trial</code> provides an object-oriented
framework for operationalizing the dose-escalation trial design. This
framework is intended as a convenient wrapper for the main model-fitting
engine of the package, the <code>blrm_exnex()</code> function. The
latter allows additional flexibility for specifying the functional form
of the model, but <code>blrm_trial</code> covers the most common
use-cases. This introductory vignette highlights <code>blrm_trial</code>
in lieu of <code>blrm_exnex</code>; the reader is referred to the
help-page of the function<code>?blrm_exnex</code> for more details.</p>
<p>One begins with <code>blrm_trial</code> by specifying three key
design elements:</p>
<ul>
<li>The historical dose-toxicity data</li>
<li>Information about the study drugs</li>
<li>The provisional dose levels to be studied during the escalation
trial</li>
</ul>
<p>Information about the study drugs is encoded through a
<code>tibble</code> as below. This includes the names of the
study-drugs, the reference doses (see [3] or <code>?blrm_exnex</code> to
understand the role this choice plays in the model specification), the
dosing units, and (optionally) the a priori expected DLT rate for each
study drug given individually at the respective reference doses.</p>
<p>All design information for the study described in [1] is also
included as built-in datasets, which are part of the
<code>OncoBayes2</code> package.</p>
<div id="drug-info" class="section level4">
<h4>Drug info</h4>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">kable</span>(drug_info_combo2)</span></code></pre></div>
<table>
<thead>
<tr>
<th align="left">drug_name</th>
<th align="right">dose_ref</th>
<th align="left">dose_unit</th>
<th align="right">reference_p_dlt</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">drug_A</td>
<td align="right">6</td>
<td align="left">mg</td>
<td align="right">0.2</td>
</tr>
<tr>
<td align="left">drug_B</td>
<td align="right">1500</td>
<td align="left">mg</td>
<td align="right">0.2</td>
</tr>
</tbody>
</table>
</div>
<div id="dose-info" class="section level4">
<h4>Dose info</h4>
<p>The provisional dose levels are specified as below. For conciseness,
we limit the dose level of in these provisional doses.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>dose_info <span class="ot">&lt;-</span> <span class="fu">filter</span>(</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  dose_info_combo2, group_id <span class="sc">==</span> <span class="st">&quot;trial_AB&quot;</span>,</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  drug_A <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">6</span>), drug_B <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">400</span>, <span class="dv">800</span>)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="fu">kable</span>(dose_info)</span></code></pre></div>
<table>
<thead>
<tr>
<th align="left">group_id</th>
<th align="right">drug_A</th>
<th align="right">drug_B</th>
<th align="right">dose_id</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">trial_AB</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">27</td>
</tr>
<tr>
<td align="left">trial_AB</td>
<td align="right">3</td>
<td align="right">400</td>
<td align="right">28</td>
</tr>
<tr>
<td align="left">trial_AB</td>
<td align="right">3</td>
<td align="right">800</td>
<td align="right">30</td>
</tr>
<tr>
<td align="left">trial_AB</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">35</td>
</tr>
<tr>
<td align="left">trial_AB</td>
<td align="right">6</td>
<td align="right">400</td>
<td align="right">36</td>
</tr>
<tr>
<td align="left">trial_AB</td>
<td align="right">6</td>
<td align="right">800</td>
<td align="right">38</td>
</tr>
</tbody>
</table>
</div>
<div id="initializing-a-blrm_trial" class="section level4">
<h4>Initializing a <code>blrm_trial</code></h4>
<p>Together with the data described in the previous section, these
objects can be used to initialize a <code>blrm_trial</code> object.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>combo2_trial_setup <span class="ot">&lt;-</span> <span class="fu">blrm_trial</span>(</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="at">data =</span> hist_combo2,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="at">drug_info =</span> drug_info_combo2,</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="at">dose_info =</span> dose_info</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## No stratum defined - assigning all groups to single stratum &quot;all&quot;</code></pre>
<pre><code>## Please configure blrm_exnex using the update() function.</code></pre>
</div>
</div>
<div id="specifying-the-prior-and-fitting-the-model" class="section level3">
<h3>Specifying the prior and fitting the model</h3>
<p>At this point, the trial design has been initialized. However, in the
absence of <code>simplified_prior = TRUE</code>, we have not yet
specified the prior distribution for the dose-toxicity model.</p>
<p>OncoBayes2 provides two methods for completing the model
specification:</p>
<ol style="list-style-type: decimal">
<li><p>Use <code>simplified_prior = TRUE</code>, which employs a
package-default prior distribution, subject to a small number of
optional arguments controlling the details.</p></li>
<li><p>Provide a full prior specification to be passed to the
<code>blrm_exnex</code> function.</p></li>
</ol>
<p>For simplicity and conciseness purposes, here we use method #1, which
is not recommended for actual trials as the prior should be chosen
deliberately and there is no guarantee that the simplified prior will
remain stable across releases of the package. See
<code>?&#39;example-combo2_trial&#39;</code> for an example of #2. The below
choice of prior broadly follows the case study in [4], although we
slightly deviate from the model in [4] by a different reference dose and
mean reference DLT rate.</p>
<p>To employ the simplified prior, and fit the model with MCMC:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>combo2_trial_start <span class="ot">&lt;-</span> <span class="fu">blrm_trial</span>(</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  <span class="at">data =</span> hist_combo2,</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  <span class="at">drug_info =</span> drug_info_combo2,</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  <span class="at">dose_info =</span> dose_info,</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>  <span class="at">simplified_prior =</span> <span class="cn">TRUE</span>,</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>  <span class="at">EXNEX_comp =</span> <span class="cn">FALSE</span>,</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>  <span class="at">EX_prob_comp_hist =</span> <span class="dv">1</span>,</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>  <span class="at">EX_prob_comp_new =</span> <span class="dv">1</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Warning in .blrm_trial_compute_simple_prior(object = trial, EXNEX_comp =
## EXNEX_comp, : Simplified prior CAN and WILL change with releases. NOT
## recommended to use in production. Instantiating a simplified prior - run
## summary(trial, &quot;blrm_exnex_call&quot;) to inspect arguments.</code></pre>
<pre><code>## Warning: There were 2 divergent transitions after warmup. See
## https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
## to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>## Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
<pre><code>## Warning: 1 out of 6 ewoc metrics are within the 95% MCMC error of the decision boundary.
## Be careful when using the imprecise ewoc estimates! It is recommended to run
## more iterations and review doses close to critical thresholds.
## You may call &quot;summary(trial, summarize=&#39;ewoc_check&#39;, ...)&quot; for more diagnostic details.
## Please call &quot;help(&#39;blrm_trial&#39;, help_type=&#39;summary&#39;)&quot; for further documentation.</code></pre>
<p>Now, the object <code>combo2_trial_start</code> contains the
posterior model fit at the start of the trial, in addition to the trial
design details. Next we highlight the main methods for extracting
relevant information from it.</p>
</div>
<div id="summary-of-prior-specification" class="section level3">
<h3>Summary of prior specification</h3>
<p>The function <code>prior_summary</code> provides a facility for
printing, in a readable format, a summary of the prior
specification.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">prior_summary</span>(combo2_trial_start) <span class="co"># not run here</span></span></code></pre></div>
</div>
<div id="summary-of-posterior" class="section level3">
<h3>Summary of posterior</h3>
<p>The main target of inference is generally the probability of DLT at a
selection of provisional dose levels. To obtain these summaries for the
provisional doses specified previously, we simply write:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">summary</span>(combo2_trial_start, <span class="st">&quot;dose_prediction&quot;</span>), <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="7%" />
<col width="5%" />
<col width="5%" />
<col width="6%" />
<col width="9%" />
<col width="4%" />
<col width="4%" />
<col width="4%" />
<col width="4%" />
<col width="5%" />
<col width="12%" />
<col width="10%" />
<col width="11%" />
<col width="6%" />
</colgroup>
<thead>
<tr>
<th align="left">group_id</th>
<th align="right">drug_A</th>
<th align="right">drug_B</th>
<th align="right">dose_id</th>
<th align="left">stratum_id</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">2.5%</th>
<th align="right">50%</th>
<th align="right">97.5%</th>
<th align="right">prob_underdose</th>
<th align="right">prob_target</th>
<th align="right">prob_overdose</th>
<th align="left">ewoc_ok</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">trial_AB</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">27</td>
<td align="left">all</td>
<td align="right">0.08</td>
<td align="right">0.13</td>
<td align="right">0.00</td>
<td align="right">0.05</td>
<td align="right">0.45</td>
<td align="right">0.88</td>
<td align="right">0.08</td>
<td align="right">0.04</td>
<td align="left">TRUE</td>
</tr>
<tr>
<td align="left">trial_AB</td>
<td align="right">3</td>
<td align="right">400</td>
<td align="right">28</td>
<td align="left">all</td>
<td align="right">0.15</td>
<td align="right">0.17</td>
<td align="right">0.01</td>
<td align="right">0.09</td>
<td align="right">0.74</td>
<td align="right">0.72</td>
<td align="right">0.18</td>
<td align="right">0.09</td>
<td align="left">TRUE</td>
</tr>
<tr>
<td align="left">trial_AB</td>
<td align="right">3</td>
<td align="right">800</td>
<td align="right">30</td>
<td align="left">all</td>
<td align="right">0.23</td>
<td align="right">0.20</td>
<td align="right">0.02</td>
<td align="right">0.17</td>
<td align="right">0.86</td>
<td align="right">0.48</td>
<td align="right">0.32</td>
<td align="right">0.20</td>
<td align="left">TRUE</td>
</tr>
<tr>
<td align="left">trial_AB</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">35</td>
<td align="left">all</td>
<td align="right">0.18</td>
<td align="right">0.17</td>
<td align="right">0.01</td>
<td align="right">0.14</td>
<td align="right">0.73</td>
<td align="right">0.60</td>
<td align="right">0.29</td>
<td align="right">0.12</td>
<td align="left">TRUE</td>
</tr>
<tr>
<td align="left">trial_AB</td>
<td align="right">6</td>
<td align="right">400</td>
<td align="right">36</td>
<td align="left">all</td>
<td align="right">0.25</td>
<td align="right">0.21</td>
<td align="right">0.02</td>
<td align="right">0.18</td>
<td align="right">0.89</td>
<td align="right">0.43</td>
<td align="right">0.32</td>
<td align="right">0.25</td>
<td align="left">TRUE</td>
</tr>
<tr>
<td align="left">trial_AB</td>
<td align="right">6</td>
<td align="right">800</td>
<td align="right">38</td>
<td align="left">all</td>
<td align="right">0.33</td>
<td align="right">0.25</td>
<td align="right">0.02</td>
<td align="right">0.26</td>
<td align="right">0.95</td>
<td align="right">0.32</td>
<td align="right">0.27</td>
<td align="right">0.40</td>
<td align="left">FALSE</td>
</tr>
</tbody>
</table>
<p>Such summaries may be used to assess which combination doses have
unacceptable high risk of toxicity. For example, according to the
escalation with overdose control (EWOC) design criteria [3], one would
compute the posterior probability that each dose is excessively toxic
(column <code>prob_overdose</code>; note that the definition of
“excessively toxic” is encoded in the <code>blrm_trial</code> object
through the <code>interval_prob</code> argument), and take as eligible
doses only those where this probability does not exceed 25% (column
<code>ewoc_ok</code>).</p>
</div>
<div id="posterior-accuracy-of-ewoc-estimation" class="section level3">
<h3>Posterior accuracy of EWOC estimation</h3>
<p>Since the posterior is represented with a large sample of the target
density, any estimate derived from it is subject to finite sampling
error. The sampling error is determined by the posterior sample size and
the quality of the used Markov chain Monte Carlo (MCMC). Hence, it is
required to ensure that the MCMC chains have converged and that the
number of samples representing the posterior is large enough to estimate
desired quantities of interest with sufficient accuracy. The
<code>OncoBayes2</code> package automatically warns in case of
non-convergence as indicated by the Rhat diagnostic [5]. All model
parameters must have an Rhat of less than <span class="math inline">\(1.1\)</span> (values much larger than <span class="math inline">\(1.0\)</span> indicate non-convergence).</p>
<p>As the primary objective for a BLRM is to determine a safe set of
doses via estimation of EWOC, the key quantities defining EWOC are
monitored for convergence and sufficient accuracy for each pre-defined
dose as well. These diagnostics can be obtained for the pre-defined set
of doses via the <code>ewoc_check</code> summary routine as:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">summary</span>(combo2_trial_start, <span class="st">&quot;ewoc_check&quot;</span>), <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Warning: 1 out of 6 ewoc metrics are within the 95% MCMC error of the decision boundary.
## Be careful when using the imprecise ewoc estimates! It is recommended to run
## more iterations and review doses close to critical thresholds.
## You may call &quot;summary(trial, summarize=&#39;ewoc_check&#39;, ...)&quot; for more diagnostic details.
## Please call &quot;help(&#39;blrm_trial&#39;, help_type=&#39;summary&#39;)&quot; for further documentation.</code></pre>
<table style="width:100%;">
<colgroup>
<col width="6%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="8%" />
<col width="13%" />
<col width="14%" />
<col width="14%" />
<col width="13%" />
<col width="14%" />
</colgroup>
<thead>
<tr>
<th align="left">group_id</th>
<th align="right">drug_A</th>
<th align="right">drug_B</th>
<th align="right">dose_id</th>
<th align="left">stratum_id</th>
<th align="right">prob_overdose_est</th>
<th align="right">prob_overdose_stat</th>
<th align="right">prob_overdose_mcse</th>
<th align="right">prob_overdose_ess</th>
<th align="right">prob_overdose_rhat</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">trial_AB</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">27</td>
<td align="left">all</td>
<td align="right">0.096</td>
<td align="right">-75.155</td>
<td align="right">0.003</td>
<td align="right">1854.488</td>
<td align="right">1.002</td>
</tr>
<tr>
<td align="left">trial_AB</td>
<td align="right">3</td>
<td align="right">400</td>
<td align="right">28</td>
<td align="left">all</td>
<td align="right">0.170</td>
<td align="right">-21.160</td>
<td align="right">0.008</td>
<td align="right">1741.408</td>
<td align="right">1.001</td>
</tr>
<tr>
<td align="left">trial_AB</td>
<td align="right">3</td>
<td align="right">800</td>
<td align="right">30</td>
<td align="left">all</td>
<td align="right">0.290</td>
<td align="right">-4.233</td>
<td align="right">0.010</td>
<td align="right">1527.318</td>
<td align="right">1.001</td>
</tr>
<tr>
<td align="left">trial_AB</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">35</td>
<td align="left">all</td>
<td align="right">0.220</td>
<td align="right">-20.480</td>
<td align="right">0.005</td>
<td align="right">1655.238</td>
<td align="right">1.001</td>
</tr>
<tr>
<td align="left">trial_AB</td>
<td align="right">6</td>
<td align="right">400</td>
<td align="right">36</td>
<td align="left">all</td>
<td align="right">0.327</td>
<td align="right">-0.397</td>
<td align="right">0.008</td>
<td align="right">1813.761</td>
<td align="right">1.001</td>
</tr>
<tr>
<td align="left">trial_AB</td>
<td align="right">6</td>
<td align="right">800</td>
<td align="right">38</td>
<td align="left">all</td>
<td align="right">0.474</td>
<td align="right">11.575</td>
<td align="right">0.012</td>
<td align="right">1771.597</td>
<td align="right">1.000</td>
</tr>
</tbody>
</table>
<p>For the standard EWOC criterion, the <code>prob_overdose_est</code>
column contains the 75% quantile of the posterior DLT probability, which
must be smaller than 33%. The <code>prob_overdose_stat</code> column is
centered by 33% and standardized with the Monte-Carlo standard error
(mcse). Therefore, negative values correspond to safe doses and since
the quantity is approximately distributed as a standard normal random
variate, the statistic can be compared with quantiles of the standard
normal distribution. <code>OncoBayes2</code> will warn for an imprecise
EWOC estimate whenever the statistic is within the range of the central
95% interval of <span class="math inline">\((-1.96,1.96)\)</span>.
Whenever this occurs it can be useful to increase the number of
iterations in order to decrease the mcse, which scales with the inverse
of the square root of the MC ess. The MC ess is the number of
independent samples the posterior corresponds to (recall that MCMC
results in correlated samples). For more information please refer to the
help of the <code>summary.blrm_trial</code> function (see
<code>help(&quot;blrm_trial&quot;, help_type=&quot;summary&quot;)</code>).</p>
<p>We can see that for the pre-defined doses of the trial the EWOC
decision can be determined with more than enough accuracy given that the
statistic closest to <span class="math inline">\(0\)</span> is <span class="math inline">\(-0.4\)</span>.</p>
</div>
<div id="posterior-predictive-summaries" class="section level3">
<h3>Posterior predictive summaries</h3>
<p>The BLRM allows a principled approach to predicting the number of
DLTs that may be observed in a future cohort. This may be a key estimand
for understanding and limiting the toxicity risk to patients. For
example, suppose a candidate starting dose for the new trial
<code>trial_AB</code> is 3 mg of drug A + 400 mg of drug B. We may wish
to check that at this dose, the predictive probability of 2 or more DLTs
out of an initial cohort of 3 to 6 patients is sufficiently low.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>candidate_starting_dose <span class="ot">&lt;-</span> <span class="fu">summary</span>(combo2_trial_start, <span class="st">&quot;dose_info&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>  <span class="fu">filter</span>(drug_A <span class="sc">==</span> <span class="dv">3</span>, drug_B <span class="sc">==</span> <span class="dv">400</span>) <span class="sc">|&gt;</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">num_toxicities =</span> <span class="dv">0</span>, <span class="at">num_patients =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>pp_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(combo2_trial_start,</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>  <span class="at">interval_prob =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">6</span>), <span class="at">predictive =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>  <span class="at">newdata =</span> candidate_starting_dose</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>)</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">bind_cols</span>(</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>  <span class="fu">select</span>(candidate_starting_dose, num_patients),</span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>  <span class="fu">select</span>(pp_summary, <span class="fu">ends_with</span>(<span class="st">&quot;]&quot;</span>))</span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a>), <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr>
<th align="right">num_patients</th>
<th align="right">(-1,0]</th>
<th align="right">(0,1]</th>
<th align="right">(1,6]</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">3</td>
<td align="right">0.685</td>
<td align="right">0.223</td>
<td align="right">0.093</td>
</tr>
<tr>
<td align="right">4</td>
<td align="right">0.624</td>
<td align="right">0.244</td>
<td align="right">0.133</td>
</tr>
<tr>
<td align="right">5</td>
<td align="right">0.572</td>
<td align="right">0.256</td>
<td align="right">0.171</td>
</tr>
<tr>
<td align="right">6</td>
<td align="right">0.528</td>
<td align="right">0.264</td>
<td align="right">0.208</td>
</tr>
</tbody>
</table>
<p>This tells us that for the initial cohort, according to the model,
the chance of two or more patients developing DLTs ranges from 9.3% to
20.8%, depending on the number of patients enrolled.</p>
</div>
<div id="updating-the-model-with-new-data" class="section level3">
<h3>Updating the model with new data</h3>
<p>Dose-escalation designs are adaptive in nature, as dosing decisions
are made after each sequential cohort. The model must be updated with
the accrued data for each dose escalation decision point. If a new
cohort of patients is observed, say:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>new_cohort <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>  <span class="at">group_id =</span> <span class="st">&quot;trial_AB&quot;</span>,</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>  <span class="at">drug_A =</span> <span class="dv">3</span>,</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>  <span class="at">drug_B =</span> <span class="dv">400</span>,</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>  <span class="at">num_patients =</span> <span class="dv">5</span>,</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>  <span class="at">num_toxicities =</span> <span class="dv">1</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>)</span></code></pre></div>
<p>One can update the model to incorporate this new information using
<code>update()</code> with <code>add_data</code> equal to the new
cohort:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>combo2_trial_update <span class="ot">&lt;-</span> <span class="fu">update</span>(combo2_trial_start, <span class="at">add_data =</span> new_cohort)</span></code></pre></div>
<pre><code>## Warning: There were 2 divergent transitions after warmup. See
## https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
## to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>## Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
<p>This yields a new <code>blrm_trial</code> object with updated data
and posterior summaries. Obtaining the summaries for the pre-planned
provisional doses is then again straightforward:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">summary</span>(combo2_trial_update, <span class="st">&quot;dose_prediction&quot;</span>), <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="7%" />
<col width="5%" />
<col width="5%" />
<col width="6%" />
<col width="9%" />
<col width="4%" />
<col width="4%" />
<col width="4%" />
<col width="4%" />
<col width="5%" />
<col width="12%" />
<col width="10%" />
<col width="11%" />
<col width="6%" />
</colgroup>
<thead>
<tr>
<th align="left">group_id</th>
<th align="right">drug_A</th>
<th align="right">drug_B</th>
<th align="right">dose_id</th>
<th align="left">stratum_id</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">2.5%</th>
<th align="right">50%</th>
<th align="right">97.5%</th>
<th align="right">prob_underdose</th>
<th align="right">prob_target</th>
<th align="right">prob_overdose</th>
<th align="left">ewoc_ok</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">trial_AB</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">27</td>
<td align="left">all</td>
<td align="right">0.08</td>
<td align="right">0.08</td>
<td align="right">0.00</td>
<td align="right">0.06</td>
<td align="right">0.29</td>
<td align="right">0.88</td>
<td align="right">0.10</td>
<td align="right">0.02</td>
<td align="left">TRUE</td>
</tr>
<tr>
<td align="left">trial_AB</td>
<td align="right">3</td>
<td align="right">400</td>
<td align="right">28</td>
<td align="left">all</td>
<td align="right">0.14</td>
<td align="right">0.10</td>
<td align="right">0.02</td>
<td align="right">0.12</td>
<td align="right">0.40</td>
<td align="right">0.67</td>
<td align="right">0.28</td>
<td align="right">0.05</td>
<td align="left">TRUE</td>
</tr>
<tr>
<td align="left">trial_AB</td>
<td align="right">3</td>
<td align="right">800</td>
<td align="right">30</td>
<td align="left">all</td>
<td align="right">0.23</td>
<td align="right">0.15</td>
<td align="right">0.04</td>
<td align="right">0.20</td>
<td align="right">0.60</td>
<td align="right">0.40</td>
<td align="right">0.39</td>
<td align="right">0.21</td>
<td align="left">TRUE</td>
</tr>
<tr>
<td align="left">trial_AB</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">35</td>
<td align="left">all</td>
<td align="right">0.18</td>
<td align="right">0.14</td>
<td align="right">0.02</td>
<td align="right">0.15</td>
<td align="right">0.52</td>
<td align="right">0.54</td>
<td align="right">0.34</td>
<td align="right">0.12</td>
<td align="left">TRUE</td>
</tr>
<tr>
<td align="left">trial_AB</td>
<td align="right">6</td>
<td align="right">400</td>
<td align="right">36</td>
<td align="left">all</td>
<td align="right">0.25</td>
<td align="right">0.16</td>
<td align="right">0.04</td>
<td align="right">0.21</td>
<td align="right">0.65</td>
<td align="right">0.35</td>
<td align="right">0.37</td>
<td align="right">0.28</td>
<td align="left">FALSE</td>
</tr>
<tr>
<td align="left">trial_AB</td>
<td align="right">6</td>
<td align="right">800</td>
<td align="right">38</td>
<td align="left">all</td>
<td align="right">0.34</td>
<td align="right">0.23</td>
<td align="right">0.04</td>
<td align="right">0.29</td>
<td align="right">0.82</td>
<td align="right">0.26</td>
<td align="right">0.29</td>
<td align="right">0.45</td>
<td align="left">FALSE</td>
</tr>
</tbody>
</table>
<p>In case posterior summaries are needed for doses other than the
pre-planned ones, then this is possible using the
<code>newdata_prediction</code> functionality, which allows to specify a
different set of doses via the <code>newdata</code> argument:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">summary</span>(combo2_trial_update, <span class="st">&quot;newdata_prediction&quot;</span>,</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>  <span class="at">newdata =</span> <span class="fu">tibble</span>(</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>    <span class="at">group_id =</span> <span class="st">&quot;trial_AB&quot;</span>,</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>    <span class="at">drug_A =</span> <span class="fl">4.5</span>,</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>    <span class="at">drug_B =</span> <span class="fu">c</span>(<span class="dv">400</span>, <span class="dv">600</span>, <span class="dv">800</span>)</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>  )</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>), <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## stratum_id not given, but only one stratum defined. Assigning first stratum.</code></pre>
<table style="width:100%;">
<colgroup>
<col width="7%" />
<col width="5%" />
<col width="5%" />
<col width="9%" />
<col width="6%" />
<col width="4%" />
<col width="4%" />
<col width="4%" />
<col width="4%" />
<col width="5%" />
<col width="12%" />
<col width="10%" />
<col width="11%" />
<col width="6%" />
</colgroup>
<thead>
<tr>
<th align="left">group_id</th>
<th align="right">drug_A</th>
<th align="right">drug_B</th>
<th align="left">stratum_id</th>
<th align="right">dose_id</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">2.5%</th>
<th align="right">50%</th>
<th align="right">97.5%</th>
<th align="right">prob_underdose</th>
<th align="right">prob_target</th>
<th align="right">prob_overdose</th>
<th align="left">ewoc_ok</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">trial_AB</td>
<td align="right">4.5</td>
<td align="right">400</td>
<td align="left">all</td>
<td align="right">NA</td>
<td align="right">0.19</td>
<td align="right">0.13</td>
<td align="right">0.03</td>
<td align="right">0.16</td>
<td align="right">0.52</td>
<td align="right">0.50</td>
<td align="right">0.37</td>
<td align="right">0.13</td>
<td align="left">TRUE</td>
</tr>
<tr>
<td align="left">trial_AB</td>
<td align="right">4.5</td>
<td align="right">600</td>
<td align="left">all</td>
<td align="right">NA</td>
<td align="right">0.24</td>
<td align="right">0.16</td>
<td align="right">0.04</td>
<td align="right">0.20</td>
<td align="right">0.62</td>
<td align="right">0.38</td>
<td align="right">0.37</td>
<td align="right">0.24</td>
<td align="left">TRUE</td>
</tr>
<tr>
<td align="left">trial_AB</td>
<td align="right">4.5</td>
<td align="right">800</td>
<td align="left">all</td>
<td align="right">NA</td>
<td align="right">0.28</td>
<td align="right">0.19</td>
<td align="right">0.04</td>
<td align="right">0.25</td>
<td align="right">0.71</td>
<td align="right">0.31</td>
<td align="right">0.34</td>
<td align="right">0.35</td>
<td align="left">FALSE</td>
</tr>
</tbody>
</table>
</div>
<div id="data-scenarios" class="section level3">
<h3>Data scenarios</h3>
<p>It may be of interest to test prospectively how this model responds
in various scenarios for upcoming cohorts.</p>
<p>This can be done easily by again using <code>update()</code> with the
<code>add_data</code> argument. In the code below, we explore 3 possible
outcomes for a subsequent cohort enrolled at 3 mg drug A + 800 mg drug
B, and review the model’s inference at adjacent doses.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="co"># set up two scenarios at the starting dose level</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a><span class="co"># store them as data frames in a named list</span></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>scenarios <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>  <span class="at">group_id =</span> <span class="st">&quot;trial_AB&quot;</span>,</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>  <span class="at">drug_A =</span> <span class="dv">3</span>,</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>  <span class="at">drug_B =</span> <span class="dv">800</span>,</span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>  <span class="at">num_patients =</span> <span class="dv">3</span>,</span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>  <span class="at">num_toxicities =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span></span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a>  <span class="fu">split</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">paste0</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="st">&quot;/3 DLTs&quot;</span>))</span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a>candidate_doses <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a>  <span class="at">group_id =</span> <span class="st">&quot;trial_AB&quot;</span>,</span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a>  <span class="at">drug_A =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="fl">4.5</span>),</span>
<span id="cb27-16"><a href="#cb27-16" tabindex="-1"></a>  <span class="at">drug_B =</span> <span class="fu">c</span>(<span class="dv">600</span>, <span class="dv">800</span>)</span>
<span id="cb27-17"><a href="#cb27-17" tabindex="-1"></a>)</span>
<span id="cb27-18"><a href="#cb27-18" tabindex="-1"></a></span>
<span id="cb27-19"><a href="#cb27-19" tabindex="-1"></a>scenario_inference <span class="ot">&lt;-</span> <span class="fu">lapply</span>(scenarios, <span class="cf">function</span>(scenario_newdata) {</span>
<span id="cb27-20"><a href="#cb27-20" tabindex="-1"></a>  <span class="co"># refit the model with each scenario&#39;s additional data</span></span>
<span id="cb27-21"><a href="#cb27-21" tabindex="-1"></a>  scenario_fit <span class="ot">&lt;-</span> <span class="fu">update</span>(combo2_trial_update, <span class="at">add_data =</span> scenario_newdata)</span>
<span id="cb27-22"><a href="#cb27-22" tabindex="-1"></a>  <span class="co"># summarize posterior at candidate doses</span></span>
<span id="cb27-23"><a href="#cb27-23" tabindex="-1"></a>  <span class="fu">summary</span>(scenario_fit, <span class="st">&quot;newdata_prediction&quot;</span>, <span class="at">newdata =</span> candidate_doses)</span>
<span id="cb27-24"><a href="#cb27-24" tabindex="-1"></a>}) <span class="sc">|&gt;</span></span>
<span id="cb27-25"><a href="#cb27-25" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="at">.id =</span> <span class="st">&quot;Scenario&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: 1 out of 6 ewoc metrics are within the 95% MCMC error of the decision boundary.
## Be careful when using the imprecise ewoc estimates! It is recommended to run
## more iterations and review doses close to critical thresholds.
## You may call &quot;summary(trial, summarize=&#39;ewoc_check&#39;, ...)&quot; for more diagnostic details.
## Please call &quot;help(&#39;blrm_trial&#39;, help_type=&#39;summary&#39;)&quot; for further documentation.</code></pre>
<table style="width:100%;">
<caption>Model inference for trial AB when varying hypothetical DLT
scenarios for a cohort of size 3</caption>
<colgroup>
<col width="9%" />
<col width="7%" />
<col width="7%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="5%" />
<col width="6%" />
<col width="15%" />
<col width="12%" />
<col width="14%" />
<col width="8%" />
</colgroup>
<thead>
<tr>
<th align="left">Scenario</th>
<th align="right">drug_A</th>
<th align="right">drug_B</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">2.5%</th>
<th align="right">50%</th>
<th align="right">97.5%</th>
<th align="right">prob_underdose</th>
<th align="right">prob_target</th>
<th align="right">prob_overdose</th>
<th align="left">ewoc_ok</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">0/3 DLTs</td>
<td align="right">3.0</td>
<td align="right">600</td>
<td align="right">0.13</td>
<td align="right">0.08</td>
<td align="right">0.03</td>
<td align="right">0.12</td>
<td align="right">0.33</td>
<td align="right">0.71</td>
<td align="right">0.27</td>
<td align="right">0.03</td>
<td align="left">TRUE</td>
</tr>
<tr>
<td align="left">0/3 DLTs</td>
<td align="right">3.0</td>
<td align="right">800</td>
<td align="right">0.16</td>
<td align="right">0.10</td>
<td align="right">0.03</td>
<td align="right">0.14</td>
<td align="right">0.43</td>
<td align="right">0.56</td>
<td align="right">0.37</td>
<td align="right">0.07</td>
<td align="left">TRUE</td>
</tr>
<tr>
<td align="left">0/3 DLTs</td>
<td align="right">4.5</td>
<td align="right">600</td>
<td align="right">0.17</td>
<td align="right">0.11</td>
<td align="right">0.03</td>
<td align="right">0.15</td>
<td align="right">0.46</td>
<td align="right">0.55</td>
<td align="right">0.36</td>
<td align="right">0.09</td>
<td align="left">TRUE</td>
</tr>
<tr>
<td align="left">0/3 DLTs</td>
<td align="right">4.5</td>
<td align="right">800</td>
<td align="right">0.21</td>
<td align="right">0.14</td>
<td align="right">0.03</td>
<td align="right">0.17</td>
<td align="right">0.56</td>
<td align="right">0.46</td>
<td align="right">0.36</td>
<td align="right">0.18</td>
<td align="left">TRUE</td>
</tr>
<tr>
<td align="left">1/3 DLTs</td>
<td align="right">3.0</td>
<td align="right">600</td>
<td align="right">0.20</td>
<td align="right">0.11</td>
<td align="right">0.05</td>
<td align="right">0.18</td>
<td align="right">0.46</td>
<td align="right">0.40</td>
<td align="right">0.48</td>
<td align="right">0.12</td>
<td align="left">TRUE</td>
</tr>
<tr>
<td align="left">1/3 DLTs</td>
<td align="right">3.0</td>
<td align="right">800</td>
<td align="right">0.26</td>
<td align="right">0.13</td>
<td align="right">0.06</td>
<td align="right">0.24</td>
<td align="right">0.56</td>
<td align="right">0.26</td>
<td align="right">0.49</td>
<td align="right">0.25</td>
<td align="left">FALSE</td>
</tr>
<tr>
<td align="left">1/3 DLTs</td>
<td align="right">4.5</td>
<td align="right">600</td>
<td align="right">0.26</td>
<td align="right">0.14</td>
<td align="right">0.06</td>
<td align="right">0.24</td>
<td align="right">0.58</td>
<td align="right">0.27</td>
<td align="right">0.45</td>
<td align="right">0.28</td>
<td align="left">FALSE</td>
</tr>
<tr>
<td align="left">1/3 DLTs</td>
<td align="right">4.5</td>
<td align="right">800</td>
<td align="right">0.32</td>
<td align="right">0.17</td>
<td align="right">0.06</td>
<td align="right">0.29</td>
<td align="right">0.70</td>
<td align="right">0.20</td>
<td align="right">0.38</td>
<td align="right">0.43</td>
<td align="left">FALSE</td>
</tr>
<tr>
<td align="left">2/3 DLTs</td>
<td align="right">3.0</td>
<td align="right">600</td>
<td align="right">0.28</td>
<td align="right">0.13</td>
<td align="right">0.08</td>
<td align="right">0.26</td>
<td align="right">0.60</td>
<td align="right">0.18</td>
<td align="right">0.50</td>
<td align="right">0.32</td>
<td align="left">FALSE</td>
</tr>
<tr>
<td align="left">2/3 DLTs</td>
<td align="right">3.0</td>
<td align="right">800</td>
<td align="right">0.36</td>
<td align="right">0.16</td>
<td align="right">0.11</td>
<td align="right">0.34</td>
<td align="right">0.71</td>
<td align="right">0.10</td>
<td align="right">0.39</td>
<td align="right">0.51</td>
<td align="left">FALSE</td>
</tr>
<tr>
<td align="left">2/3 DLTs</td>
<td align="right">4.5</td>
<td align="right">600</td>
<td align="right">0.36</td>
<td align="right">0.16</td>
<td align="right">0.10</td>
<td align="right">0.34</td>
<td align="right">0.71</td>
<td align="right">0.10</td>
<td align="right">0.37</td>
<td align="right">0.53</td>
<td align="left">FALSE</td>
</tr>
<tr>
<td align="left">2/3 DLTs</td>
<td align="right">4.5</td>
<td align="right">800</td>
<td align="right">0.44</td>
<td align="right">0.19</td>
<td align="right">0.11</td>
<td align="right">0.43</td>
<td align="right">0.81</td>
<td align="right">0.06</td>
<td align="right">0.24</td>
<td align="right">0.69</td>
<td align="left">FALSE</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="continuation-of-example-using-concurrent-data" class="section level2">
<h2>Continuation of example: Using concurrent data</h2>
<p>In the example of [1], at the time of completion of the first stage
of <code>trial_AB</code>, the following additional data was
observed.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>trial_AB_data <span class="ot">&lt;-</span> <span class="fu">filter</span>(codata_combo2, group_id <span class="sc">==</span> <span class="st">&quot;trial_AB&quot;</span>, cohort_time <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a><span class="fu">kable</span>(trial_AB_data)</span></code></pre></div>
<table>
<thead>
<tr>
<th align="left">group_id</th>
<th align="right">drug_A</th>
<th align="right">drug_B</th>
<th align="right">num_patients</th>
<th align="right">num_toxicities</th>
<th align="right">cohort_time</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">trial_AB</td>
<td align="right">3</td>
<td align="right">400</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr>
<td align="left">trial_AB</td>
<td align="right">3</td>
<td align="right">800</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr>
<td align="left">trial_AB</td>
<td align="right">6</td>
<td align="right">400</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>These data are easily incorporated into the model using another call
to <code>update</code>, as below.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>combo2_trial_histdata <span class="ot">&lt;-</span> <span class="fu">update</span>(combo2_trial_start, <span class="at">add_data =</span> trial_AB_data)</span></code></pre></div>
<pre><code>## Warning: There were 1 divergent transitions after warmup. See
## https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
## to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>## Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
<pre><code>## Warning: 1 out of 6 ewoc metrics are within the 95% MCMC error of the decision boundary.
## Be careful when using the imprecise ewoc estimates! It is recommended to run
## more iterations and review doses close to critical thresholds.
## You may call &quot;summary(trial, summarize=&#39;ewoc_check&#39;, ...)&quot; for more diagnostic details.
## Please call &quot;help(&#39;blrm_trial&#39;, help_type=&#39;summary&#39;)&quot; for further documentation.</code></pre>
<p>However, during the first stage of <code>trial_AB</code>, the
<code>trial_A</code> studying drug A did continue and collected more
data on the drug A dose-toxicity relationship:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>trial_A_codata <span class="ot">&lt;-</span> <span class="fu">filter</span>(codata_combo2, group_id <span class="sc">==</span> <span class="st">&quot;trial_A&quot;</span>, cohort_time <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a><span class="fu">kable</span>(trial_A_codata)</span></code></pre></div>
<table>
<thead>
<tr>
<th align="left">group_id</th>
<th align="right">drug_A</th>
<th align="right">drug_B</th>
<th align="right">num_patients</th>
<th align="right">num_toxicities</th>
<th align="right">cohort_time</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">trial_A</td>
<td align="right">3.0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr>
<td align="left">trial_A</td>
<td align="right">4.5</td>
<td align="right">0</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr>
<td align="left">trial_A</td>
<td align="right">6.0</td>
<td align="right">0</td>
<td align="right">11</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr>
<td align="left">trial_A</td>
<td align="right">8.0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>Wthin the MAC framework we may simply add the concurrent data to our
overall model which yields refined predictions for future cohorts.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>combo2_trial_codata <span class="ot">&lt;-</span> <span class="fu">update</span>(combo2_trial_histdata, <span class="at">add_data =</span> trial_A_codata)</span></code></pre></div>
<pre><code>## Warning in .blrm_trial_sanitize_data(trial = trial, data = args[[&quot;add_data&quot;]]):
## Data that was provided does not correspond to a pre-specified dose!</code></pre>
<p>To compare the effect of co-data in this case it is simplest to
visualize the interval probabilities as predicted by the model for the
different data constellations. Here we use the function
<code>plot_toxicity_intervals_stacked</code> to explore the
dose-toxicity relationship in a continuous manner in terms of the
dose.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="fu">plot_toxicity_intervals_stacked</span>(combo2_trial_histdata,</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>  <span class="at">newdata =</span> <span class="fu">mutate</span>(dose_info, <span class="at">dose_id =</span> <span class="cn">NULL</span>, <span class="at">stratum_id =</span> <span class="st">&quot;all&quot;</span>),</span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">vars</span>(drug_B),</span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">vars</span>(drug_A),</span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>  <span class="at">facet_args =</span> <span class="fu">list</span>(<span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Trial AB with historical data only&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">plot_toxicity_intervals_stacked</span>(combo2_trial_codata,</span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>  <span class="at">newdata =</span> <span class="fu">mutate</span>(dose_info, <span class="at">dose_id =</span> <span class="cn">NULL</span>, <span class="at">stratum_id =</span> <span class="st">&quot;all&quot;</span>),</span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">vars</span>(drug_B),</span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">vars</span>(drug_A),</span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a>  <span class="at">facet_args =</span> <span class="fu">list</span>(<span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb38-6"><a href="#cb38-6" tabindex="-1"></a>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Trial AB with historical and concurrent data on drug A&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAArsAAAIGBAMAAACmGVoaAAAACXBIWXMAABCbAAAQmwF0iZxLAAAAJ1BMVEX///+Rv9v//79+Riz8jVl9fWUKCgrt595NTU3R1NTeuaKhoaGabVZxEJAjAAAeOElEQVR42u2dP3PbyLrmnzm1+Eckd111j0vZKdaecp1J+QW26jK6EaqmBEmWAyRogmaCUl2Rkp0gEUhZCa63TEvjhIEPx0tvgES0PQqdng+1QQP8I5EUQXYDJPU+NQNrSDaG+PnR2293v2gAJBKJRCKRSCQSiZSDTMYYY3UAUC0AgLHP39EBwGaMXfmTDfinrpPXjDYAuA/Pm5xs6owTehus+H0fbzj7E3oxeJU27MiYxDv0+DvdCIDGYm1Yu8dN83WW4A1rE3g1fzbe9IwTwFlWvK17DVvzPjjn1N2oGLw+7Ag/Jl9KYNgBANgxzPvm1H30E5Kl2vTrs+U9NFNWvO17DdtzPzn71HZQDF7AjnD+EIZ2W5uH1x7j/aU2/bosvEptuqFSy4Y3uZoiZEfAhxsPnyyYYSOFoZy7Cd5uDQCG7C3zwOK3lslY1H8TWty9X1wYt4Dd6JmMRZrtRTCOusFbC7A9H99ZnJzRDBvAh5vQAhR2HQCAwtpIWly7AGzP15k/9PDhhv97xmLeZMi7B4VdB/jOYgxZnZ8aUydIPvHhxgtrJgsAu4HJqykIr85e2mYYYOj3owSvDpb0bfyL6XUMLTT5p/DXy1IDAH7xon783YMSKDGGPpqx4iJ0/9kIAzRjtWbWSvUE79DvRwp7ZzSgufx3VWuA+c1YcWF7vW6MZqzWMPTh6eylrbOXttEuubyJWQPAG5q1Uh1mDfzUwMQJkk/o7KVt1qAG0K2mF0xcTVHu7caAGsCGaiV47zCMAdixYbcBwGhADfAJaoChj/RvoVSHGsCD2kOMoY8OEEZGA1ADXKFUUxy4CV4bqoVuDA96ADUAoMfo+2mLpAGGPjx0Y6AbQwVCvxvDS/DqAdRAceDCrIGfGpg4QfIJdGNwvF2f/xWkV1MY3gj8+43wOmg6SexlSQDVHVgJ3r9GCAHglzp0Bx70OoChrzWAvmXUATXQkmjnjmIvxxuiGfMA2fSBpEUDusMbcLz8K3UZY1E3RpjgTRu6yX+7mDrB6BPdKMHLv9H4aorGWwoTvEbAkdkxwCJ+3aeNEd5+greU4NXYJTD0Sw2gGXC8JX49X0Z4S2GCtx9xSkMASYsGdIc3mMQ7BIAJvEnDLwneL+70CUafGOHtxng9eTUF4zUbzQSvzhjzUrw9AFADyzb9Oe6FyWIM/V8agJrgNesAMPyW4jUbzQTvMMUbAUmLBnQnaTCJ15/GyxsOv3G8w28upk4w+sQIr14zncmrKRiv7afBoQmA+ZPuVV5bzWvMcS+g1zD0NQ9oJsHB8ABDqY1jr58Gh27yO94NgI+8RQO6Y3iAMYW3HwPxBN5uDD1QaknsrfHgMD5B+okxXoSuP3k1RSjspXg1dxR7jwHYFmDHMHjs1Zivv76PN3WvCa2GoY/QR9/neMEsLWhaKV5+7m6MEKqTxHkXZ0mLBnQHzNIC3mkmeNUGzvwJvKoDlZ/SrIGfGpMnSD6BbpT0uWaCNL2aAqSxIMHrgKEfgAHQagCadWjM0oZJ1Oqg5ACqg27cm3Yvg9ozHXTjXrOmNWDUAdXBkLFIdUoeeFLE0A+S33QXXRYBJmN18BYN6LwBmpbJnASvyViDNzEaJYA37DolD0ajxE+NyRMkn4i6ETQXQ4ZmconJ1RQSGxjrqYzBZCzqu4o7ZHXAZjFMxgKbMeYmFvgIxDAZi3RXZ26T1QCE7IAxm9UV2/Whu4DtRWDMMRmLjPASJWbZFh8T9F3FVZjXZDV88a6/AcC1F/EWNmsz5hvhJVBi1lWTMaiMAUOvlzTho5gv3vW3ErNsC6HF/8TkCZJPqIwBfVf/hi5jVxhfDc3gCR7yh4zFhEGWBoBhEQZJMhwAEXGQ1Wu7Pn4nDNJ0fW+phUQikUgkEolEIpFIJBKJRCKRSCQSiSRenx6+lC6Pmx4tNa4pc0Zl+FXy5zdeY0daQ7cPXjHOkh981ImPeLz6KCaQe9eT4t7i7izshRYUL1kX90sBzAAAFIq96+lKu9Bd6D3Fwq2R1ANGSG4NMEIqUlpLRoBbHHO87/COv5jebwQYV4RorbxhAu93XPLXgH76/jUhWguvM8areHGKV00z3w+EaC01YAfH0K0zd3Tv8hGgpHcFt4nQWrp2785YoHW+9vCFXQGAwiKE7G0AILygGjthiqFRHiYvDLfxVmWM0UhCjg49utOBRCKRSKRt1jEhkKkLQkB4CS8p1ekVABxeEF4papsx0rkVwitaZowAUCg4yJHSwyWgH/vApzvCKxxvhCMA55f38P7PrdbH8n0V6l7gbDo4aFtN96S8KXh57E02ZN4RvM/LG4MX7VIMAH/e69q2Ge8MuuW/FZf3atb1RbQ77n1W3iD3zhm1bS/dvfLm49V2ql8j90qmW1js3TH3PptNl9wrLSej2Cs1JyP3itL7uXgp9srKyci90s1LsVdiv0bulZjyUuyVbl5yr1TzUuyVal5yr7ykjGKv5NBA7pWX8lLslR0ayL1SQwPFXolZA7lX1jwkxV6JSxQbgJcXoOJgm937ON3CYm/bjJE+3n1L3fu+vLHuLfEiqFZ7e927V95cvEkJX9SerpDcJveebDLeCEdACW3gw/5Wuvf5MnSLir3cvRG2N/YuZd5iC1APO514S2Pv+/Im400LUA+21L3LhYZC817NArY0c9hbki7NOUilS3MOUunSnIO0pIHcK50uxV4Z82TkXqnzZBR78zEvuVeqeSn2yhkMk3ulDoYp9uYQGsi9UkMDxV6poYHcKzU0UOyVl/KSe6Wbl2KvVPOSe6Wal2KvVPOSe+UlZRR7JU2ik3ulj9c2oABVO4y3xL0r0i2ujMSMAQNH2+HeVekWFXvTXfh+bIV7n69Kt+g9JGPg98Gmu3evvHV4+Q6o3w+Af9/fdPeelLfVvbdbEHufrU636Ni7BTugPl+DbtEFqJ82370n24j39AqadbYFO6C+L28j3m0Zta0VGmjOQcYsJLk3l8BL871yQwO5V9ZwjWKv/NBA7pVLl2KvrIyX3Cu5W6PYK7VbI/fKG09Q7JXdrZF7pXZrFHsle5fcK5cuxV6JkYHcKy3hpdgrNeEl9+ZAl2KvvG6N3CubLsVeqXTnujdkjHkqa3TZa4QeNJsdADgNve/CFuJnFKAW7d5n5ZzwllzgGnaM0IcSY/hNs3swPd9ggspIzBgo4Xij3LtXzguv5gImmgG6MXSUGoBSR98CVCF0+Q6oPj5slHtPhOP92wK8MRQHqoNTqA4ADwyAKbSE79N0Aaq2Y3QXuVcLYDTQreEHuhaA0PBEF6AiBv65KTugSqA7Hy9jLAA8HDQQoB8DCD81RBegGv7mxF4ZdB9xL2zfCrUYfxWNNylA/bg5ea8Uuo/EXjR/RP1PfhIczl3BBaiGD39D3CuH7sLMAYB+BXUfk12byALU605nQ9wrie5ivDHMBpTXSBOzoQUo/g6O2mTRXTysiIAaNAfAMNbsGIrnG1c7OOcgje7c2BsyxhgAC7AAGMmgmLk+ds698ujSjJnQtR+a75U/jUPulbSyRvO98ifJyL35dGsUe6V2a+Te55LpPu3Yuyeb7tN278kTw6vtVOAtl3/1n6575dP9XPWfrHvzoFt9su6VHndffK5Wn6p792TT/fVztVp9ou7dk2/danUD8Wo7ku6WP28kXuwG3Rcp3Sx4zdCLoDAW9Flji937MUe6GfAanl/ygG4dhudvr3ulh91fx3Cz4G0GQDOA6kC3BBWgGoe5u1c+3Wp1JbyhDyh1qA5ELBa3zRjJLnE5uncvZ7rL49UYAMOD6pxFwoqg9HzdKz/sDqor4jU8zlh9XRdXwqcDOL/Jyb3y4d6zbha8JRcAGFRPRClUUoCqA7jNZwdU+XGh/Ht1dbwj9zpDR6h7c4m9e/kmDOvEXtPbttjbym+YtireicxhGAgqQM3Jve/zHEisinec9yqekLxXs4zOZQ7ufV9Al7bOqE1j7S0atRXSpa0x52B1GettyZzDnvxs7E21KgTv9s2Y5ZCM/eNzdXvwalsGd0HUzRmvlbN784D74nO1eLxaq9VqnTu5ujcPuI9aNx+8OmOMMSdH9+bQoZXL55+rG4HXqLVarVZu7v2Yh3GXcW5esdfKL/bmYdulgm7eXVucg3uf5wP3zbJw5+NV9sdaf+3HPN6XH3vziQovBtUMygevHYZS3bv3sZUL2/KvmeDmhbema5Ek9+61ynnpTUa2ueF1zCgQ796b/MiWXww+V1dQPnivtEuBsXfvppUj2Iyd2Yp4dRYA01Nly5ftdGGLcu/ex3zJll8MBtWVtbx7+y6g1FYt2zHWnjHL37Pzl9Ak4FVZDC2JE2bGsp14zRmzvZNyIRpU19TyeHW7PsI7zFi2s9jdi9x7k1fK9SAmnA8+V6s54tWZr1kwwgZM5mUr26ndZXTvf998LMiw6+QJa+EFq2kWhn43gJ25bOduOfeWi9f5YFAVpix4m55moYFSA3bmsp3lMoci8bZarTeiTLsSXoO1rVIN8Kbdu0TZTntYn1WA+nAH1FxxvhkMBoPPoomujBdDzzJrQAg7Y9nOw7y4bcaA7t/ljPfFm8FgMBhIRboyXoVZRgPowM5YtjPaXy7d4JPvgPr1/mOgIcmmOUNdKe8FEFrwAB57s5TtjPJitT1ZwvcSejRVgPqX1pL6Y1qDh/rP6iZoebzdCNAt9C0lwPDcz1S2E47wvj2aKEA9ghJNFaCitWPC8nMOLqDFMMIG0HydrWznAkhz49LRPfdOBYenIrEzZqdAml0o7OWoAPXuQewlvCutVngex6uWWGzW0gJU3f9KeAXgHd7dJXiZBXhpAerDvJfwrlRJkgYHtQ082KeW8K4r3x9xTvecftJ4BddBOcpoWPHHojkH0io6dIzR2EQnHKJVczSHZ8qdTkg4RMtxSrxrszudI8IhWgeOymd9FGIho2tz2WhygwiL120MABq0VqtLNEQrRskHwKDwDe9JYrs2IABwA6PWahIOwfrudTpO6mOKvcJH2F6nE1HXJk3JrEWr1aKuTR7hkDHq2iTI3N93AHRbrRZ1beIVeh0nDbsUe4WrNl5rI7xSAq9PozZpesPdS6M2SbGX37JNozY56qcrxTRqkzJsG40sjI9EQ3DSm9g2CRMxEREq1QfSxEypn18SEbF4vU6nEzop6jMiIhbvxGYvOq8TJgkODnwhHiWf8IpPG/jADYcXHXe/Q0QkadjpdDpt4iArTBCCnNJgkhTd7tsEQbRGIzXF8xqEQ7RGGw6ofnBOOESrdhulndsPqu+VoH9yvnp8RqsVEmS7PQAwHBH72pOm5fQbGCbxNyIcosVcgBdQ03S6pMxBdQBoNJ3OYyVjbEzC4PuXdf2J9+flr9czbrIPABg+aDo91TGGkbkAr8bmbFWgzHojKZ+m6fQxkGG0cHe3uQlAcwZehxuYptPH6kcLh7cJXnMZvOPy6eKm0z8tuBbjOP/vM5yFVwnu4T1cBq/idS4iAIcXnYuCptNN9+Fr6eaB2lVB7h16sclqLDAOYIZtfPBt9p05egOAh1LbDhTWgO3CbHdsDyy+ZtbM4JDujVjgdPrtg1eMtBcQ8eTaVdyrB4aHbvwnhnVcIDRZpAcIoQUAPNivtQY60P2zIHRtpYYzXGmNmXgTwkWG3Rl49eT3s5Ap0n6Ero9hpHk+tLrhoItmpAdo9swIgAfTgYsO+ozVTAdo4BuAixl4fYyfumL8UQhcxb3F3VnYCy2Y6fSdXwpgBgBcu12Ie4dAs4frGFrdDAA0IyWAwjcP8GA6uMAh9gGYDjBEDO27+xCv6sAePXUlZEX8JuJKu9Bd6D3Fwr7h+snonKebRqMI/w4jdHvo+iZeQ6ubNYC7F+7/ncDbwRDQTAdQj4HDaIZ7jQjd9KkrZuO8iH7ECHCLY473Hd4lI3XGuzvDQTP/iRA7hl7HBf7EsKfVwX7cohkpTo/vuacxjtcuqa/PLdMBjAaM15o786uaae+mR4Xs52BO4P2Oy/Q79VO8ai/vb9RkDBiyWGFgrs2sUxYrzDU8H2oEwGauzZos6La10AVjERAA4eXwlrkLzqoW07+Zzhiv4sUpXpX/VE/K4DZDKxToNtPNXlSgkOn0BuzgGLp15uJH8tIPQOFd2hf/+wYN5/7M3qSTzl+YB6VCljKv3bszFmidrzG+sys+NxIhZG8DAKXQ2hi4xqInr82TA2OUOQSFz6ZoGzyjr3n+KnjNNO/9UfD3N9t4qy5+PN/W6RbNJHMo/qoOvZ2b0Ne9ZBZYtxY+IIS0mj4ljtEsmu+VIh4cFBbSPmaCNTGlYzbuhgREqKamdAIKDqIz5fGUzu3MTvuGGK2ZbCbT6bPv136CO6D+MvHUqX8T1bUN/+jHhFc83gAlB8A7GAHhFY/3NfoOAAdwZgwrCO+aarxtjPDyzOH0CgAOLwivALw+L25wj/fdfT6saJsx0qkrwruue/nzxNhoHzP+WBCFgsMIb5dZRsiXqa49brsPFgBj3+8+tvzL/D8dAPXRLnxKD5eAfuwD3zsTdTs35x8F/dP6y6p6MxAnf3m8QD/qRwBK9VIdAHTbArSO/3idS53P91pAuplZhCMAvBp1/WfEP9QaT9r8+744RVnwulAcAKqVFAaoFtC18DjeeOKZYhi7F7wada1nxAunWz4tCG+pDqMOXr8TpXgZlsCL3+/9lvDYi/uPZNI2gG5h7lUcaA0ANtCME7zK62Xw6g9W59ulGEiWRYW79/1aTycsyr26wx/LGHLfAqoFtRFePo53+O363mj49AqadX0RyXDvenQLc6/u8LLeML3NR7XQbGuh/yjey7Q6HY9M6WwAXYHuffWzt6Z7uzGa1qN4nYktOhfhFeHe5+s+ulSYe39WKr01Y2+zBzVYAq/h5OTevbWfDCvIva8qlWx4S7Ukc/DHmYNqQX8c763fj3Ny7/vyhrj3Z1a8aPDRgRpjmOa9igM1XiJzWHQnsUj3Pi9viHt/q2TG24+aEfRaqa7VgUOgaQEuho9kDuYd8DVCPu49KW+IeyvZ8RrhJaC7fM6hA52xGAqzHsGrPlYVI9C9AuiKcW9lBbxcM+4QW4wXS+PVNoCuEPf+XBnvrPWcJfDmkTm8F/JM+VNxdLPgTWYdtYcfXjwhqd7c3Nx8yiHvfS6ErgD3juhmwLuyJrfolOpeMXTXd++Ybi547+7u7m7lu/ekvBnunaA7F69A5RR735c3w72TdPPD60t2rzC667n3VaWyDN6/TPz//rYm3jzyXnF013Lvz0rueJVj+XmvQLrruLdSyR/vo1rfvc8E0l3dva8qG45XKzThXdO9M+juhHv3hNJd1b2/VSo76V7BdFd078/Kmni1OK3SMfb50R9X7BjhFT8YC2/ZluBe0XRXc2+lsi7erp9U6eDCRVKeM6rY+QQ74ofsJWPrufekXLx7X1XWxqvV0iodvqDZTVczbQDoQY35YTm8vAAVB2u7VzjdFdz7W2V9vGovrdLhePltEqOKHT44U5cteGybMQCjva573wunm9298+lmwNsfrRQDLpLynPGqsdZOD8vgLfEiqFZ7Tfc+F083s3sX0M2AtzOqcwBcJOU545qHkPnJYRm8SQlf1J4uQNWK7tZWcO8iuhnwuqMqHcBFUp4zrtjRhkFyWApvhCOghDXde1Iu3L0L6WbA25h2Ly/PGbsXSi05LO/eCOvF3mflwt37qiIM71Ts5eU549gLrZYclsHLC1APO514Dfc+l0I3k3sfoZspOKRVOjz2WtCDiYod/sgwzVk2c+AFqAdruFcS3Szu/a0iDG9nVKXDMwcHajxRsQMzTg7L5r2ahXViryy6Gdz7syIOb1qlowTQXCTlOeGbpGLH9a/BDzmN2qTRXd69j3o3C169l1TpBAhZA7w8J7SSih3b64Ef1sGLYlOyjO6tiMSrzVqMNOKFtOS5Vx7dpd37UyjeyY3pR7qGULwoNOHN5N5XlYpYvLOc+pD4WhOSWnEzDRnd+1tFNN7NWa2QSncp9/6sbCNercDBWhb3Lks3jzIS0e59LpfuEu5dmu6G4dUKThqWc+/ydOfi/R/Vsf73Jrl376RcrHtfVSrbilcrPDI86t5KZXvxYgPoLnTvq8o249U2gO4i92alu13uPcmD7iL3Viq76969cj76u4iUITvecZXOtRcnB16x013vUSpLuvckJ7yn4uhmwTuq0jFipc4PacWObsl37/tywe5dgW4GvOMqnRLQ4Ie0pESX795nedGd595V6GbAO1mlw29EcYTj1YrNGRa597eKXLyTVTpnfnrIyb17+dGd7d5XFcl4J6p0dFZLDnm5N0e6M937syIb72SVzlsvPeTj3pNyoe5d0bqZ8E5W6cD208OKeE+vAGiH8VLuzZXuQ/euTjcT3nHs5c+8a66Bt23GgIGjZdxbzlena4/VVgsO4yodNEeH1fCmu/D9eNy9eznTfeDeSi54J6t0cDc6rIY3KUBFfG8H1EIzstnu/ZkP3nGVjnpgBFAPjAAIfW01vHwH1O8HgNZa5N7cvXvfvb9V8sE7rtJR2DtAYe8AhFbIGmu49/ax2HtSLta969HNMiheUKWzcux9bAfUAuhOufdnJS+8i6p0VsgceAHqp8XufV8A3Qn3/qtSyQ/v/CqdFSYkT6+gWWeP7IBaCN2Re19VKnnizX214lkhdFP3iqC7yasVz4uhm7q3IhNv8VU6ewXR5e4V4t1NrtIpim757+Lobq57T8oFulcU3Y1177Nyke6tVHbbvXvF0S2fiqO7oe4tkm757z8ru+3eQumW/09lp927d1Io3V//o7LL7n1WLlbV/9hl9z4vmO7n6i67d69wujvt3pPC6e6ye58VT3eX8W4AXcIrKyWrEl55elElvNJDA+GVo/+qEl7pgZfwStGb6k7hnV2AWhTeF5+ru4W3bcZACcebgHcK7k7g5Tug+viwAXj/Ua3uGt60hO/TvQLUQvu0HcLLC1ARA61Woe59Ua3urHsNv/Dg8HkX8SYFqB8LT8we0t2NzKEUA4YPv1i8M+juSt6rWde8VysO7yy6NGoTPs1AeHOjS3il0iW8coYThFfiUJjwyk8aCK8g/a8q4S0g8BJeyXQJ77r6vUp4i+jVCO/a87uDapXw5jd7TnhzpUt416jsJ7zFdWqEVz5dwiukWoTw5jdSI7z5WJfwyoVLeOXFhd0qQDUOc8Gbje7uFKDyXeJk431RfXJ4kyKoPPBmpbtDJXw6pBegZurVdqwAVYfsAtTsdHfMvdKCw4vBYFBdQRR75dh21wpQJeL9vVp9ynhPr6BZRudSCt7VnUujtseNuxZcwrvw7so12RJemWgJ7xJ3BRNewXhfDKpVwisJr6CoQHglG5fw3mf7uVolvFLwtiSwJbzctm+koH3SeFutk3JrMKjK1ZPE+0Y21SeLV75hnwreF+Vyudz6o9UaDAaDQav1Jl+yO45Xq26ACC/hJbyEl/ASXsJLeAkv4RW5ED9jB1TCK6qMxIwB3b8jvDLEd0D9+uAx0IRXYAnfS+jRVAGqNtgA/b9/iVNUEN4IR8ARlAjnNxcgSXPv1IwZSYh4Aerd/dhLEpU5lGJA978SXll5r2Y93PmfJHW1giRenZsnoKgwvEP2BFQvDK/WSnX2rSVQp3PP9vYg+9lWaXPeHv3ob0CY0GPB2V/md+bLsFYwTrBRUXiT8ZZWwGsQ3ifkXhKJRCKRdktGxxJ1qtMraIdxulg6JcWf9858vY3TMy6fNRweZG4jV2fRvqhTRUqk+3fpYumUrv157yxM8dpmnKmN7n/I3Eau9nEmbOxoRl+hp4ulU6468+e8M1+3fAEgUxsdZilrG7m6gt4ThhcvoUfJctNUBNL9Oe8s+GL7kdLDZaY2pYNe5jbS8YoKVOaFfwQlOoJy/+J6+rx35vcJbaOtRDjK0gb43sveRjZeYV/FtGZ71EB29xoWXmZ2oom7DXPvPnRx83bBHfR0sXQyb+h0rma/s3Dq4IcZ8zMuLQV65jayM4dbcUlerPtf08XSe4nZvHfm6qUWoF2KM7XR/bPMbbYl79U6RyLzXvPCz5zDGhuX95JIJBKJRCKRnobePshAFcbYSwIjRuxhgt90NNsiMkKkPsSrBlAdIiNE+ky8OuGV6d4hzQmIkMm+x2a7EwbdBkphEnBVxl4TGhE69Ptx6NpKgAa6fnjE8TrakLo2ATJqUGPTgRKggUN0/TQ4KGRfEbHBgT7Ca0ONUrwll+Csr9Kke7txf9S1mQ2CI0Ce3/RMB0rNYFaJtdNhBfqUmInQGfsSMxZpYfsd3k4Mium2L+GymUfZrkQnh6zGGGMUF2RIa0PrEQZpeG2ahiSRSCQSiUQikUgkAP8f8XTJ1FKHanoAAAAASUVORK5CYII=" width="100%" style="display: block; margin: auto;" /></p>
<p>As we can observe, the additional data on drug A moves the maximal
admissible dose allowed by EWOC towards higher doses for drug B whenever
drug A is 6 mg. This reflects that drug A has been observed to be
relatively safe, since no DLT was observed for a number of doses.</p>
<p>In the example of [1], during the conduct of the second stage of the
<code>trial_AB</code> an additional external data source from a new
trial became available. This time it is stemming from another trial
which is an investigator-initiated trial <code>IIT</code> of the same
combination. Numerous toxicities were observed in this concurrent study
as stage 2 of <code>trial_AB</code>.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>trial_AB_stage_2_codata <span class="ot">&lt;-</span> <span class="fu">filter</span>(codata_combo2, cohort_time <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a><span class="fu">kable</span>(trial_AB_stage_2_codata)</span></code></pre></div>
<table>
<thead>
<tr>
<th align="left">group_id</th>
<th align="right">drug_A</th>
<th align="right">drug_B</th>
<th align="right">num_patients</th>
<th align="right">num_toxicities</th>
<th align="right">cohort_time</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">IIT</td>
<td align="right">3.0</td>
<td align="right">400</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">2</td>
</tr>
<tr>
<td align="left">IIT</td>
<td align="right">3.0</td>
<td align="right">800</td>
<td align="right">7</td>
<td align="right">5</td>
<td align="right">2</td>
</tr>
<tr>
<td align="left">IIT</td>
<td align="right">4.5</td>
<td align="right">400</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">2</td>
</tr>
<tr>
<td align="left">IIT</td>
<td align="right">6.0</td>
<td align="right">400</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">2</td>
</tr>
<tr>
<td align="left">IIT</td>
<td align="right">6.0</td>
<td align="right">600</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">2</td>
</tr>
<tr>
<td align="left">trial_AB</td>
<td align="right">3.0</td>
<td align="right">400</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">2</td>
</tr>
<tr>
<td align="left">trial_AB</td>
<td align="right">3.0</td>
<td align="right">800</td>
<td align="right">6</td>
<td align="right">2</td>
<td align="right">2</td>
</tr>
<tr>
<td align="left">trial_AB</td>
<td align="right">4.5</td>
<td align="right">600</td>
<td align="right">10</td>
<td align="right">2</td>
<td align="right">2</td>
</tr>
<tr>
<td align="left">trial_AB</td>
<td align="right">6.0</td>
<td align="right">400</td>
<td align="right">10</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
<p>As before, through the MAC framework, these data can influence the
model summaries for <code>trial_AB</code>. We leave it to the reader to
explore the differences in the co-data (combined historical and
concurrent data) vs the historical data only approach.</p>
<p>To conclude we present a graphical summary of the dose-toxicity
relationship for the dual combination trial for the final data
constellation. Note that we use the <code>data</code> option of
<code>update</code> here to ensure that we use an entirely new dataset
which includes all data collected; so this includes historical, trial
and concurrent data:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>combo2_trial_final <span class="ot">&lt;-</span> <span class="fu">update</span>(combo2_trial_start, <span class="at">data =</span> codata_combo2)</span></code></pre></div>
<pre><code>## Warning in .blrm_trial_sanitize_data(trial = trial, data = args[[&quot;data&quot;]]):
## Data that was provided does not correspond to a pre-specified dose!</code></pre>
<pre><code>## Warning: There were 1 divergent transitions after warmup. See
## https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
## to find out why this is a problem and how to eliminate them.</code></pre>
<pre><code>## Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
<p>As final summary we consider the 75% quantile of the probability for
a DLT at all dose combinations. Whenever the 75% quantile exceeds 33%,
then the EWOC criterion is violated and the dose is too toxic.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a>grid_length <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>dose_info_plot_grid <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(</span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a>  <span class="at">stratum_id =</span> <span class="st">&quot;all&quot;</span>,</span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a>  <span class="at">group_id =</span> <span class="st">&quot;trial_AB&quot;</span>,</span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a>  <span class="at">drug_A =</span> <span class="fu">seq</span>(<span class="fu">min</span>(dose_info_combo2<span class="sc">$</span>drug_A),</span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a>               <span class="fu">max</span>(dose_info_combo2<span class="sc">$</span>drug_A),</span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a>               <span class="at">length.out =</span> grid_length),</span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a>  <span class="at">drug_B =</span> <span class="fu">seq</span>(<span class="fu">min</span>(dose_info_combo2<span class="sc">$</span>drug_B),</span>
<span id="cb44-10"><a href="#cb44-10" tabindex="-1"></a>               <span class="fu">max</span>(dose_info_combo2<span class="sc">$</span>drug_B),</span>
<span id="cb44-11"><a href="#cb44-11" tabindex="-1"></a>               <span class="at">length.out =</span> grid_length)</span>
<span id="cb44-12"><a href="#cb44-12" tabindex="-1"></a>)</span>
<span id="cb44-13"><a href="#cb44-13" tabindex="-1"></a></span>
<span id="cb44-14"><a href="#cb44-14" tabindex="-1"></a></span>
<span id="cb44-15"><a href="#cb44-15" tabindex="-1"></a>dose_info_plot_grid_sum <span class="ot">&lt;-</span> <span class="fu">summary</span>(combo2_trial_final,</span>
<span id="cb44-16"><a href="#cb44-16" tabindex="-1"></a>  <span class="at">newdata =</span> dose_info_plot_grid,</span>
<span id="cb44-17"><a href="#cb44-17" tabindex="-1"></a>  <span class="at">prob =</span> <span class="fl">0.5</span></span>
<span id="cb44-18"><a href="#cb44-18" tabindex="-1"></a>)</span>
<span id="cb44-19"><a href="#cb44-19" tabindex="-1"></a></span>
<span id="cb44-20"><a href="#cb44-20" tabindex="-1"></a><span class="fu">ggplot</span>(dose_info_plot_grid_sum, <span class="fu">aes</span>(drug_A, drug_B, <span class="at">z =</span> <span class="sc">!!</span><span class="fu">as.name</span>(<span class="st">&quot;75%&quot;</span>))) <span class="sc">+</span></span>
<span id="cb44-21"><a href="#cb44-21" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.16</span>, <span class="fl">0.33</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb44-22"><a href="#cb44-22" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="st">&quot;Quantile Range&quot;</span>, <span class="at">type =</span> <span class="st">&quot;div&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb44-23"><a href="#cb44-23" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;DLT Probability 75% Quantile&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" width="100%" style="display: block; margin: auto;" /></p>
<!---
## Advanced topics

### Grouping and stratification factors

A brief note on terminology: the `group_id` variable, present in the `data`
and `dose_info` arguments of a `blrm_trial` object, divides observations and
dose levels into homogeneous groups sharing the same set of parameters
in the hierarchical model. These `group_id`'s are referred to as "strata"
in [1], [2], and [4]. No confusion should arise between this terminology
and the `stratum_id` variable, an optional set of higher-level stratifying
factors which can serve to divide the `group_id`'s into classes which 
share the same heterogeneity parameters. For more information on models
employing multiple `stratum_id`'s, the user is referred to the
section of `?blrm_exnex` on differential discounting, and to 
`?example-combo3` for an example.
-->
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>[1] Neuenschwander, B., Roychoudhury, S., &amp; Schmidli, H. (2016).
On the use of co-data in clinical trials. Statistics in
Biopharmaceutical Research, 8(3), 345-354.</p>
<p>[2] Neuenschwander, B., Wandel, S., Roychoudhury, S., &amp; Bailey,
S. (2016). Robust exchangeability designs for early phase clinical
trials with multiple strata. Pharmaceutical statistics, 15(2),
123-134.</p>
<p>[3] Neuenschwander, B., Branson, M., &amp; Gsponer, T. (2008).
Critical aspects of the Bayesian approach to phase I cancer trials.
Statistics in medicine, 27(13), 2420-2439.</p>
<p>[4] Neuenschwander, B., Matano, A., Tang, Z., Roychoudhury, S.,
Wandel, S. Bailey, Stuart. (2014). A Bayesian Industry Approach to Phase
I Combination Trials in Oncology. In Statistical methods in drug
combination studies (Vol. 69). CRC Press.</p>
<p>[5] Vehtari, A., Gelman, A., Simpson, D., Carpenter, B., Bürkner, P.
C. (2021). Rank-Normalization, Folding, and Localization: An Improved
(<span class="math inline">\(\hat{R}\)</span>) for Assessing Convergence
of MCMC, Bayesian Analysis, 16 (2), 667–718. <a href="https://doi.org/10.1214/20-BA1221" class="uri">https://doi.org/10.1214/20-BA1221</a></p>
</div>
<div id="session-info" class="section level2">
<h2>Session Info</h2>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.4.2 (2024-10-31)
## Platform: aarch64-apple-darwin20
## Running under: macOS Sequoia 15.3.1
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib 
## LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## time zone: Europe/Zurich
## tzcode source: internal
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] tibble_3.2.1     tidyr_1.3.1      dplyr_1.1.4      ggplot2_3.5.1   
## [5] knitr_1.47       posterior_1.6.0  OncoBayes2_0.9-1 RBesT_1.8-1     
## 
## loaded via a namespace (and not attached):
##  [1] gtable_0.3.5          tensorA_0.36.2.1      xfun_0.45            
##  [4] bslib_0.7.0           QuickJSR_1.2.2        inline_0.3.19        
##  [7] vctrs_0.6.5           tools_4.4.2           generics_0.1.3       
## [10] stats4_4.4.2          curl_5.2.1            parallel_4.4.2       
## [13] fansi_1.0.6           highr_0.11            pkgconfig_2.0.3      
## [16] checkmate_2.3.1       RColorBrewer_1.1-3    distributional_0.4.0 
## [19] RcppParallel_5.1.7    assertthat_0.2.1      lifecycle_1.0.4      
## [22] farver_2.1.2          compiler_4.4.2        textshaping_0.4.0    
## [25] munsell_0.5.1         codetools_0.2-20      htmltools_0.5.8.1    
## [28] sass_0.4.9            bayesplot_1.11.1      yaml_2.3.8           
## [31] Formula_1.2-5         pillar_1.9.0          jquerylib_0.1.4      
## [34] cachem_1.1.0          StanHeaders_2.32.9    abind_1.4-5          
## [37] rstan_2.32.6          tidyselect_1.2.1      digest_0.6.35        
## [40] mvtnorm_1.2-5         purrr_1.0.2           labeling_0.4.3       
## [43] fastmap_1.2.0         grid_4.4.2            colorspace_2.1-0     
## [46] cli_3.6.2             magrittr_2.0.3        loo_2.7.0            
## [49] pkgbuild_1.4.4        utf8_1.2.4            withr_3.0.0          
## [52] scales_1.3.0          backports_1.5.0       rmarkdown_2.27       
## [55] matrixStats_1.3.0     gridExtra_2.3         ragg_1.3.2           
## [58] evaluate_0.24.0       V8_4.4.2              rstantools_2.4.0.9000
## [61] rlang_1.1.4           isoband_0.2.7         Rcpp_1.0.12          
## [64] glue_1.7.0            jsonlite_1.8.8        R6_2.5.1             
## [67] systemfonts_1.1.0</code></pre>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
